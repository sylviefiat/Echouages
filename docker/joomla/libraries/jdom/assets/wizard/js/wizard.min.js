/*
 * FORK of wizard on https://github.com/ExactTarget/fuelux
 *
 * Copyright (c) 2013 Girolamo Tomaselli http://bygiro.com
 * Licensed under the MIT license.
 */
;!function(a){var d=a.fn.wizard,e=function(b,c){var d=this;this.$element=a(b),this.options=a.extend({},a.fn.wizard.defaults,c),this.options.disablePreviousStep="previous"===this.$element.data().restrict?!0:!1,this.currentStep=this.options.selectedItem.step,this.numSteps=this.$element.find(".steps li").length,this.parent=this.$element.parent(),this.$prevBtn=this.parent.find(this.options.prevButtons),this.$nextBtn=this.parent.find(this.options.nextButtons),this.$nextBtn.each(function(){a(this).data("originalHTML",a(this).html())}),this.$element.parent().on("click",this.options.prevButtons,function(a){a.stopPropagation(),d.previous.call(d,a)}),this.$element.parent().on("click",this.options.nextButtons,function(a){a.stopPropagation(),d.next.call(d,a)}),this.$element.on("click","li.complete",function(a){a.stopPropagation(),d.stepclicked.call(d,a)}),this.currentStep>1&&this.selectedItem(this.options.selectedItem),1==this.currentStep?this.$prevBtn.css("display","none"):this.$prevBtn.css("display","inline-block")};e.prototype={constructor:e,setState:function(){var b=this.currentStep>1,c=1===this.currentStep,d=this.currentStep===this.numSteps;this.options.disablePreviousStep||(c===!0||b===!1?this.$prevBtn.css("display","none"):this.$prevBtn.css("display","inline-block"));var e=this.$nextBtn.data();e&&e.originalHTML&&"undefined"!=typeof e.originalHTML&&(d===!0?(this.$nextBtn.html(this.options.text.finished),this.$nextBtn.addClass("btn-success")):(this.$nextBtn.html(e.originalHTML),this.$nextBtn.removeClass("btn-success")));var f=this.$element.find(".steps li");f.removeClass("active").removeClass("complete"),f.find("span.badge").removeClass("badge-info").removeClass("badge-success");var g=".steps li:lt("+(this.currentStep-1)+")",h=this.$element.find(g);h.addClass("complete"),h.find("span.badge").addClass("badge-success");var i=".steps li:eq("+(this.currentStep-1)+")",j=this.$element.find(i);j.addClass("active").trigger("shown"),j.find("span.badge").addClass("badge-info");var k=j.data().target;this.$element.next(".step-content").find(".step-pane").removeClass("active"),a(k).addClass("active").trigger("shown"),this.$element.find(".steps").first().attr("style","left: 0");var l=0;this.$element.find(".steps > li").each(function(){l+=a(this).outerWidth()});var m=0;if(m=this.$element.find(".actions").length?this.$element.width()-this.$element.find(".actions").first().outerWidth():this.$element.width(),l>m){var n=m/2,o=this.$element.find("li.active").first(),p=o.outerWidth()/2;newMargin=n-p-o.position().left,newMargin>0?this.$element.find(".steps").first().attr("style","left: 0"):this.$element.find(".steps").first().attr("style","left: "+newMargin+"px")}},stepclicked:function(b){var c=a(b.currentTarget),d=this.$element.find(".steps li").index(c),e=!0;if(this.options.disablePreviousStep&&d<this.currentStep&&(e=!1),e){var f=a.Event("stepclick");if(this.$element.trigger(f,{step:d+1}),f.isDefaultPrevented())return;this.currentStep=d+1,this.setState()}},previous:function(){var b=this.currentStep>1;if(this.options.disablePreviousStep&&(b=!1),b){var c=a.Event("changeStep");if(this.$element.trigger(c,{step:this.currentStep,direction:"previous"}),c.isDefaultPrevented())return;this.currentStep-=1,this.setState()}},next:function(){var b=this.currentStep+1<=this.numSteps,c=this.currentStep===this.numSteps;if(b){var d=a.Event("changeStep"),e=this.$element.find(".steps li").eq(this.currentStep-1),f=this.$element.find(".steps li").eq(this.currentStep);if(this.$element.trigger(d,{step:this.currentStep,direction:"next",current:e,next:f}),d.isDefaultPrevented())return;this.currentStep+=1,this.setState()}else c&&this.$element.trigger("finished",{step:this.currentStep})},selectedItem:function(a){var b,c;return a?(c=a.step||-1,c>=1&&c<=this.numSteps&&(this.currentStep=c,this.setState()),b=this):b={step:this.currentStep},b}},a.fn.wizard=function(b){var d,c=Array.prototype.slice.call(arguments,1),f=this.each(function(){var f=a(this),g=f.data("wizard"),h="object"==typeof b&&b;g||f.data("wizard",g=new e(this,h)),"string"==typeof b&&(d=g[b].apply(g,c))});return void 0===d?f:d},a.fn.wizard.defaults={selectedItem:{step:1},nextButtons:".btn-next",prevButtons:".btn-prev",text:{finished:"Finished"}},a.fn.wizard.Constructor=e,a.fn.wizard.noConflict=function(){return a.fn.wizard=d,this},a(function(){a("body").on("mouseover.wizard.data-api",".wizard",function(){var b=a(this);b.data("wizard")||b.wizard(b.data())})})}(jQuery,document,window);