/*
* A jQuery Geolocation API Extended
*
* @author: Girolamo Tomaselli
* @url: http://bygiro.com
* @email: http://girotomaselli@gmail.com
* based on a FORK of https://github.com/manuelbieh/jQuery-Geolocation
* @published: 27-10-2013
* @version 0.0.1
* @license MIT
*/
!function(a){a.extend({geolocation:{received:!1,timedout:!1,location_timeout:null,watchIDs:[],get:function(b){b=jQuery.geolocation.prepareOptions(b),"undefined"!=typeof b.message&&a(b.message).addClass(a.geolocation.browser()).show(),a.geolocation.getCurrentPosition(b.successCallback,b.errorCallback,b.timedoutCallback,b.options)},watch:function(b){return b=jQuery.geolocation.prepareOptions(b),a.geolocation.watchPosition(b.successCallback,b.errorCallback,b.timedoutCallback,b.options)},stop:function(a){"undefined"!=typeof navigator.geolocation&&navigator.geolocation.clearWatch(a)},getCurrentPosition:function(b,c,d,e){"undefined"!=typeof navigator.geolocation?(a.geolocation.location_timeout=setTimeout(d,e.timeout),navigator.geolocation.getCurrentPosition(b,c,e)):(errorcode={NOT_SUPPORTED:!0},c(errorcode))},watchPosition:function(b,c,d,e){return"undefined"!=typeof navigator.geolocation?(watchID=navigator.geolocation.watchPosition(b,c,e),a.geolocation.watchIDs.push(watchID),watchID):(errorcode={NOT_SUPPORTED:!0},c(errorcode),void 0)},clearWatch:function(b){a.geolocation.stop(b)},prepareOptions:function(b){return b.errorCallback=function(c){c.NOT_SUPPORTED||(a.geolocation.received=!0),clearTimeout(a.geolocation.location_timeout),"undefined"!=typeof b.message&&a(b.message).hide(),"function"!=typeof b.error&&(b.error=function(){}),b.error(c)},b.successCallback=function(c){a.geolocation.received=!0,clearTimeout(a.geolocation.location_timeout),"undefined"!=typeof b.message&&a(b.message).hide(),"function"!=typeof b.success&&(b.success=function(){}),a.geolocation.position=c,b.success(c)},b.timedoutCallback=function(){a.geolocation.timedout=!0,"undefined"!=typeof b.message&&a(b.message).hide(),a.geolocation.received||("function"!=typeof b.timedout&&(b.timedout=function(){}),b.timedout())},("undefined"==typeof b.options||b.options.length<=0)&&(b.options={highAccuracy:!1,maximumAge:3e4,timeout:6e3}),b},stopAll:function(){a.each(jQuery.geolocation.watchIDs,function(b,c){a.geolocation.stop(c)})},browser:function(){var c,a=navigator.appName,b=navigator.userAgent,d=b.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);return d&&null!=(c=b.match(/version\/([\.\d]+)/i))&&(d[2]=c[1]),d=d?[d[1],d[2]]:[a,navigator.appVersion,"-?"],d[0]}}})}(jQuery);